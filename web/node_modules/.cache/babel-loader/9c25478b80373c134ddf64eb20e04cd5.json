{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Hyejin Kim/Documents/Programming/Chatapp/\\uC138\\uBC88\\uC9F8- \\uB9AC\\uC561\\uD2B8,CSS/my-chat-app-3/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Hyejin Kim/Documents/Programming/Chatapp/\\uC138\\uBC88\\uC9F8- \\uB9AC\\uC561\\uD2B8,CSS/my-chat-app-3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef,useState}from'react';import'./Chat.css';import{Box}from'@mui/material';import io from'socket.io-client';import TextEditor1 from'./TextEditor1';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chat=function Chat(){// const [state, setState] = useState({ message: '', name: '' });\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),chat=_useState2[0],setChat=_useState2[1];//react-quill WYSIWYG\nvar _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),htmlContent=_useState4[0],setHtmlContent=_useState4[1];var quillRef=useRef();// send and receive message\nvar socketRef=useRef();useEffect(function(){socketRef.current=io.connect('http://localhost:4000');socketRef.current.on('message',function(_ref){var message=_ref.message;setChat([].concat(_toConsumableArray(chat),[{message:message}]));});return function(){return socketRef.current.disconnect();};},[chat]);// const onTextChange = (e) => {\n//   setState({ ...state, [e.target.name]: e.target.value });\n// };\nvar onMessageSubmit=function onMessageSubmit(e){e.preventDefault();var message=htmlContent;socketRef.current.emit('message',{message:message});setHtmlContent('');};var renderChat=function renderChat(){return chat.map(function(_ref2,index){var message=_ref2.message;return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"div\",{dangerouslySetInnerHTML:{__html:message},className:\"sent-message\"})},index);});};//\n//scroll to bottom  (ScrollintoView)\nvar messagesEndRef=useRef();var scrollToBottom=function scrollToBottom(){var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(function(){scrollToBottom();},[chat]);//\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"background\",children:/*#__PURE__*/_jsxs(Box,{className:\"chat\",children:[/*#__PURE__*/_jsx(Box,{className:\"chat-header\",children:\"HEADER\"}),/*#__PURE__*/_jsxs(Box,{className:\"chat-contents\",children:[/*#__PURE__*/_jsx(\"ul\",{className:\"render-chat\",children:renderChat()}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(Box,{className:\"chat-footer\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"chat-footer-input\",onSubmit:onMessageSubmit,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(TextEditor1,{quillRef:quillRef,htmlContent:htmlContent,setHtmlContent:setHtmlContent})}),/*#__PURE__*/_jsx(\"button\",{className:\"chat-footer-input-button\"// onClick={handleSubmit}\n,children:\"Send Message\"})]})})]})});};export default Chat;","map":{"version":3,"names":["React","useEffect","useRef","useState","Box","io","TextEditor1","Chat","chat","setChat","htmlContent","setHtmlContent","quillRef","socketRef","current","connect","on","message","disconnect","onMessageSubmit","e","preventDefault","emit","renderChat","map","index","__html","messagesEndRef","scrollToBottom","scrollIntoView","behavior"],"sources":["C:/Users/Hyejin Kim/Documents/Programming/Chatapp/세번째- 리액트,CSS/my-chat-app-3/web/src/components/Chat.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\nimport './Chat.css';\r\n\r\nimport { Box } from '@mui/material';\r\nimport io from 'socket.io-client';\r\nimport TextEditor1 from './TextEditor1';\r\n\r\nconst Chat = () => {\r\n  // const [state, setState] = useState({ message: '', name: '' });\r\n  const [chat, setChat] = useState([]);\r\n\r\n  //react-quill WYSIWYG\r\n  const [htmlContent, setHtmlContent] = useState('');\r\n  const quillRef = useRef();\r\n\r\n  // send and receive message\r\n  const socketRef = useRef();\r\n\r\n  useEffect(() => {\r\n    socketRef.current = io.connect('http://localhost:4000');\r\n    socketRef.current.on('message', ({ message }) => {\r\n      setChat([...chat, { message }]);\r\n    });\r\n    return () => socketRef.current.disconnect();\r\n  }, [chat]);\r\n\r\n  // const onTextChange = (e) => {\r\n  //   setState({ ...state, [e.target.name]: e.target.value });\r\n  // };\r\n\r\n  const onMessageSubmit = (e) => {\r\n    e.preventDefault();\r\n    const message = htmlContent;\r\n    socketRef.current.emit('message', { message });\r\n    setHtmlContent('');\r\n  };\r\n\r\n  const renderChat = () => {\r\n    return chat.map(({ message }, index) => (\r\n      <li key={index}>\r\n        <div\r\n          dangerouslySetInnerHTML={{ __html: message }}\r\n          className=\"sent-message\"\r\n        ></div>\r\n      </li>\r\n    ));\r\n  };\r\n  //\r\n\r\n  //scroll to bottom  (ScrollintoView)\r\n  const messagesEndRef = useRef();\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [chat]);\r\n  //\r\n\r\n  return (\r\n    <div className=\"background\">\r\n      <Box className=\"chat\">\r\n        <Box className=\"chat-header\">HEADER</Box>\r\n        <Box className=\"chat-contents\">\r\n          <ul className=\"render-chat\">{renderChat()}</ul>\r\n\r\n          {/* scroll to bottom  (ScrollintoView) */}\r\n          <div ref={messagesEndRef}></div>\r\n        </Box>\r\n        <Box className=\"chat-footer\">\r\n          <form className=\"chat-footer-input\" onSubmit={onMessageSubmit}>\r\n            <div>\r\n              <TextEditor1\r\n                quillRef={quillRef}\r\n                htmlContent={htmlContent}\r\n                setHtmlContent={setHtmlContent}\r\n              />\r\n            </div>\r\n            <button\r\n              className=\"chat-footer-input-button\"\r\n              // onClick={handleSubmit}\r\n            >\r\n              Send Message\r\n            </button>\r\n          </form>\r\n        </Box>\r\n      </Box>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"wYAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,CAAmCC,QAAnC,KAAmD,OAAnD,CAEA,MAAO,YAAP,CAEA,OAASC,GAAT,KAAoB,eAApB,CACA,MAAOC,GAAP,KAAe,kBAAf,CACA,MAAOC,YAAP,KAAwB,eAAxB,C,wFAEA,GAAMC,KAAI,CAAG,QAAPA,KAAO,EAAM,CACjB;AACA,cAAwBJ,QAAQ,CAAC,EAAD,CAAhC,wCAAOK,IAAP,eAAaC,OAAb,eAEA;AACA,eAAsCN,QAAQ,CAAC,EAAD,CAA9C,yCAAOO,WAAP,eAAoBC,cAApB,eACA,GAAMC,SAAQ,CAAGV,MAAM,EAAvB,CAEA;AACA,GAAMW,UAAS,CAAGX,MAAM,EAAxB,CAEAD,SAAS,CAAC,UAAM,CACdY,SAAS,CAACC,OAAV,CAAoBT,EAAE,CAACU,OAAH,CAAW,uBAAX,CAApB,CACAF,SAAS,CAACC,OAAV,CAAkBE,EAAlB,CAAqB,SAArB,CAAgC,cAAiB,IAAdC,QAAc,MAAdA,OAAc,CAC/CR,OAAO,8BAAKD,IAAL,GAAW,CAAES,OAAO,CAAPA,OAAF,CAAX,GAAP,CACD,CAFD,EAGA,MAAO,kBAAMJ,UAAS,CAACC,OAAV,CAAkBI,UAAlB,EAAN,EAAP,CACD,CANQ,CAMN,CAACV,IAAD,CANM,CAAT,CAQA;AACA;AACA;AAEA,GAAMW,gBAAe,CAAG,QAAlBA,gBAAkB,CAACC,CAAD,CAAO,CAC7BA,CAAC,CAACC,cAAF,GACA,GAAMJ,QAAO,CAAGP,WAAhB,CACAG,SAAS,CAACC,OAAV,CAAkBQ,IAAlB,CAAuB,SAAvB,CAAkC,CAAEL,OAAO,CAAPA,OAAF,CAAlC,EACAN,cAAc,CAAC,EAAD,CAAd,CACD,CALD,CAOA,GAAMY,WAAU,CAAG,QAAbA,WAAa,EAAM,CACvB,MAAOf,KAAI,CAACgB,GAAL,CAAS,eAAcC,KAAd,KAAGR,QAAH,OAAGA,OAAH,oBACd,iCACE,YACE,uBAAuB,CAAE,CAAES,MAAM,CAAET,OAAV,CAD3B,CAEE,SAAS,CAAC,cAFZ,EADF,EAASQ,KAAT,CADc,EAAT,CAAP,CAQD,CATD,CAUA;AAEA;AACA,GAAME,eAAc,CAAGzB,MAAM,EAA7B,CAEA,GAAM0B,eAAc,CAAG,QAAjBA,eAAiB,EAAM,2BAC3B,uBAAAD,cAAc,CAACb,OAAf,sEAAwBe,cAAxB,CAAuC,CAAEC,QAAQ,CAAE,QAAZ,CAAvC,EACD,CAFD,CAIA7B,SAAS,CAAC,UAAM,CACd2B,cAAc,GACf,CAFQ,CAEN,CAACpB,IAAD,CAFM,CAAT,CAGA;AAEA,mBACE,YAAK,SAAS,CAAC,YAAf,uBACE,MAAC,GAAD,EAAK,SAAS,CAAC,MAAf,wBACE,KAAC,GAAD,EAAK,SAAS,CAAC,aAAf,oBADF,cAEE,MAAC,GAAD,EAAK,SAAS,CAAC,eAAf,wBACE,WAAI,SAAS,CAAC,aAAd,UAA6Be,UAAU,EAAvC,EADF,cAIE,YAAK,GAAG,CAAEI,cAAV,EAJF,GAFF,cAQE,KAAC,GAAD,EAAK,SAAS,CAAC,aAAf,uBACE,cAAM,SAAS,CAAC,mBAAhB,CAAoC,QAAQ,CAAER,eAA9C,wBACE,kCACE,KAAC,WAAD,EACE,QAAQ,CAAEP,QADZ,CAEE,WAAW,CAAEF,WAFf,CAGE,cAAc,CAAEC,cAHlB,EADF,EADF,cAQE,eACE,SAAS,CAAC,0BACV;AAFF,0BARF,GADF,EARF,GADF,EADF,CA8BD,CApFD,CAsFA,cAAeJ,KAAf"},"metadata":{},"sourceType":"module"}